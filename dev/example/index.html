<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Computing the genus of a punctured plane · CompScienceMeshes.jl Docs</title><meta name="title" content="Computing the genus of a punctured plane · CompScienceMeshes.jl Docs"/><meta property="og:title" content="Computing the genus of a punctured plane · CompScienceMeshes.jl Docs"/><meta property="twitter:title" content="Computing the genus of a punctured plane · CompScienceMeshes.jl Docs"/><meta name="description" content="Documentation for CompScienceMeshes.jl Docs."/><meta property="og:description" content="Documentation for CompScienceMeshes.jl Docs."/><meta property="twitter:description" content="Documentation for CompScienceMeshes.jl Docs."/><meta property="og:url" content="https://krcools.github.io/CompScienceMeshes.jl/example/"/><meta property="twitter:url" content="https://krcools.github.io/CompScienceMeshes.jl/example/"/><link rel="canonical" href="https://krcools.github.io/CompScienceMeshes.jl/example/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">CompScienceMeshes.jl Docs</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">CompScienceMeshes.jl</a></li><li><a class="tocitem" href="../charts/">Charts</a></li><li class="is-active"><a class="tocitem" href>Computing the genus of a punctured plane</a></li><li><a class="tocitem" href="../neighborhood/">Neighborhoods</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Computing the genus of a punctured plane</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Computing the genus of a punctured plane</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/krcools/CompScienceMeshes.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/krcools/CompScienceMeshes.jl/blob/master/docs/src/example.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Computing-the-genus-of-a-punctured-plane"><a class="docs-heading-anchor" href="#Computing-the-genus-of-a-punctured-plane">Computing the genus of a punctured plane</a><a id="Computing-the-genus-of-a-punctured-plane-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-the-genus-of-a-punctured-plane" title="Permalink"></a></h1><p>In this example we will compute the genus of a punctured plane. In other words we are interested in the dimension of the 1st homology space.</p><p>First we need to create the mesh. Typically this is done in an external mesher such as <code>gmsh</code> but here we will construct it from scratch.</p><pre><code class="language-julia hljs">using CompScienceMeshes

h = 1/6
rect = meshrectangle(1.0, 1.0, h, 3)
hole = meshrectangle(1/3, 1/3, h, 3)
translate!(hole, point(1/3, 1/3, 0))

pred = overlap_gpredicate(hole)
all_faces = submesh((m,c)-&gt;!pred(chart(rect,c)), rect)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Generating a structured mesh: The dimensions of the cuboid are
            approximated by multiples of edge length. For exact dimensions and
            unstructured grids, use kwarg - generator = :gmsh</code></pre><p>Note that we started out creating a large rectangular mesh and a small one. Next we translate the small one to the center of the large one. We can use <code>submesh</code> to select the part of the mesh that does not coincide with the hole by providing an appropriate predicate.</p><p>The tricky bit is that in order to get the correct number, we need to discard any vertices and edges that lie on the boundary of the structure. To do this we first retrieve a list of all edges and vertices by again calling <code>skeleton</code> with the appropriate dimension. In a next step we select out those vertices and edges that are not on the boundary.</p><p><em>Note</em>: <code>overlap_predicate</code> generates a predicate that takes cells of the same dimensionality as its argument. This means that we first need the 0-skeleton of the boundary before we can create a predicate that takes vertices of the original mesh.</p><pre><code class="language-julia hljs">all_edges = skeleton(all_faces, 1)
all_verts = skeleton(all_faces, 0)

bnd_edges = boundary(all_faces)
bnd_verts = skeleton(bnd_edges, 0)

#onbnd1 = overlap_gpredicate(bnd_edges)
#onbnd0 = overlap_gpredicate(bnd_verts)

interior_edges = submesh(!in(bnd_edges), all_edges)
interior_verts = submesh(!in(bnd_verts), all_verts)</code></pre><p>The set of interior_edges looks like this.</p><p><img src="../assets/edges.png" alt/></p><p>The co-boundary maps are simply the connectivity matrices between cells of the dimension 0-1 and 1-2, respectively. The genus can be computed by simply using the rank nullity theorem, but as part of this example we use the <code>rank</code> and <code>nullspace</code> on the connectivty matrices. This if desired can provide a representative of the cohomology space.</p><pre><code class="language-julia hljs">D0 = connectivity(interior_verts, interior_edges)
D1 = connectivity(interior_edges, all_faces)

using LinearAlgebra
nullity(A) = size(A,2) - rank(A&#39;)
genus = nullity(Matrix(D1)) - rank(Matrix(D0))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1</code></pre><p>Of course we could have just computed Euler&#39;s number and deduced the genus from that:</p><pre><code class="language-julia hljs"> 1 - length(all_faces) + length(interior_edges) - length(interior_verts)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../charts/">« Charts</a><a class="docs-footer-nextpage" href="../neighborhood/">Neighborhoods »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 20 August 2025 14:32">Wednesday 20 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
